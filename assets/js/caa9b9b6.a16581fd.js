"use strict";(self.webpackChunkdsd_project=self.webpackChunkdsd_project||[]).push([[5634],{7761:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>c,toc:()=>l});var r=t(4848),a=t(8453);const i={sidebar_label:"Ph\xe2n lo\u1ea1i d\u1eef li\u1ec7u text v\u1edbi Deberta Sequence Classification"},s="Ph\xe2n lo\u1ea1i d\u1eef li\u1ec7u text v\u1edbi Deberta Sequence Classification",c={id:"pytorch/Deberta/DebertaForSequenceClassification",title:"Ph\xe2n lo\u1ea1i d\u1eef li\u1ec7u text v\u1edbi Deberta Sequence Classification",description:"B\u01b0\u1edbc 1: C\xe0i \u0111\u1eb7t c\xe1c th\u01b0 vi\u1ec7n c\u1ea7n thi\u1ebft",source:"@site/docs/pytorch/00-Deberta/00-DebertaForSequenceClassification.md",sourceDirName:"pytorch/00-Deberta",slug:"/pytorch/Deberta/DebertaForSequenceClassification",permalink:"/docs/pytorch/Deberta/DebertaForSequenceClassification",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_label:"Ph\xe2n lo\u1ea1i d\u1eef li\u1ec7u text v\u1edbi Deberta Sequence Classification"}},o={},l=[];function d(e){const n={code:"code",h1:"h1",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"ph\xe2n-lo\u1ea1i-d\u1eef-li\u1ec7u-text-v\u1edbi-deberta-sequence-classification",children:"Ph\xe2n lo\u1ea1i d\u1eef li\u1ec7u text v\u1edbi Deberta Sequence Classification"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B\u01b0\u1edbc 1: C\xe0i \u0111\u1eb7t c\xe1c th\u01b0 vi\u1ec7n c\u1ea7n thi\u1ebft"})}),"\n",(0,r.jsx)(n.p,{children:"N\u1ebfu b\u1ea1n ch\u01b0a c\xe0i \u0111\u1eb7t c\xe1c th\u01b0 vi\u1ec7n, h\xe3y c\xe0i \u0111\u1eb7t ch\xfang b\u1eb1ng c\xe1c l\u1ec7nh sau:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip install transformers[torch]\r\npip install torch\r\npip install datasets\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B\u01b0\u1edbc 2: Chu\u1ea9n b\u1ecb d\u1eef li\u1ec7u"})}),"\n",(0,r.jsx)(n.p,{children:"Trong v\xed d\u1ee5 n\xe0y, ch\xfang ta d\xf9ng d\u1eef li\u1ec7u imdb"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# Load dataset\r\ndataset = load_dataset("imdb")\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u1ede \u0111\xe2y m\xecnh d\xf9ng d\u1eef li\u1ec7u nh\u1ecf n\xean l\u1ea5y m\u1eabu"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# L\u1ea5y m\u1eabu\r\ntrain_dataset_small = dataset['train'].train_test_split(test_size=0.01)['test']\r\neval_dataset_small = dataset['test'].train_test_split(test_size=0.01)['test']\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B\u01b0\u1edbc 3: T\u1ea1o tokenizer"})}),"\n",(0,r.jsxs)(n.p,{children:["B\u1ea1n c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,r.jsx)(n.code,{children:"DebertaTokenizer"})," ri\xeang cho m\xf4 h\xecnh Deberta, ho\u1eb7c c\xf3 th\u1ec3 s\u1eed d\u1ee5ng ",(0,r.jsx)(n.code,{children:"AutoTokenizer"}),", T\u1ea3i v\u1ec1 v\xe0 l\u01b0u l\u1ea1i t\u1ea1i ",(0,r.jsx)(n.code,{children:"cache_dir"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"tokenizer = DebertaTokenizer.from_pretrained('microsoft/deberta-base',cache_dir='D:/Vendors/huggingface/hub/')\r\n# tokenizer = DebertaTokenizer.from_pretrained('microsoft/deberta-base',cache_dir='D:/Vendors/huggingface/hub/')\n"})}),"\n",(0,r.jsxs)(n.p,{children:["T\u1ea1o h\xe0m tokenize, trong v\xed d\u1ee5 d\u01b0\u1edbi \u0111\xe2y x\u1eed l\xfd d\u1eef li\u1ec7u t\u1ea1i tr\u01b0\u1eddng ",(0,r.jsx)(n.code,{children:"text"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Tokenize data\r\ndef tokenize_function(examples):\r\n    return tokenizer(examples['text'], padding=\"max_length\", truncation=True, max_length=1024)\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B\u01b0\u1edbc 4: T\u1ea1o train eval d\u01b0\u1edbi tokenizer"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'\r\n# T\u1ea1o dataset train eval\r\ntokenized_train_dataset = train_dataset_small.map(tokenize_function, batched=True)\r\ntokenized_eval_dataset = eval_dataset_small.map(tokenize_function, batched=True)\r\n\r\n# Thay \u0111\u1ed5i t\xean c\u1ed9t v\xe0 format\r\ntokenized_train_dataset = tokenized_train_dataset.rename_column("label", "labels")\r\ntokenized_train_dataset.set_format("torch", columns=["input_ids", "attention_mask", "labels"])\r\n\r\ntokenized_eval_dataset = tokenized_eval_dataset.rename_column("label", "labels")\r\ntokenized_eval_dataset.set_format("torch", columns=["input_ids", "attention_mask", "labels"])\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B\u01b0\u1edbc 5: t\u1ea1o Model"})}),"\n",(0,r.jsxs)(n.p,{children:["Trong v\xed d\u1ee5 n\xe0y, ch\xfang ta ch\u1ec9 s\u1eed d\u1ee5ng model m\u1eabu n\xean ch\u1ec9 c\u1ea7n t\u1ea3i v\u1ec1. Ch\xfang ta c\xf3 th\u1ec3 d\xf9ng ",(0,r.jsx)(n.code,{children:"DebertaForSequenceClassification"})," ho\u1eb7c ",(0,r.jsx)(n.code,{children:"AutoModelForSequenceClassification"}),"\r\nV\u1edbi ",(0,r.jsx)(n.code,{children:"num_labels=2"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"model = DebertaForSequenceClassification.from_pretrained('microsoft/deberta-base', num_labels=2,cache_dir='D:/Vendors/huggingface/hub/')\r\n# model = AutoModelForSequenceClassification.from_pretrained('microsoft/deberta-base', num_labels=2,cache_dir='D:/Vendors/huggingface/hub/')\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"B\u01b0\u1edbc 5: Hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh"})}),"\n",(0,r.jsx)(n.p,{children:"T\u1ea1o Training Arguments"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'training_args = TrainingArguments(\r\n    output_dir="./results",\r\n    fp16=True,\r\n    eval_strategy="epoch",\r\n    learning_rate=2e-5,\r\n    per_device_train_batch_size=4,\r\n    per_device_eval_batch_size=8,\r\n    num_train_epochs=3,\r\n    weight_decay=0.01,\r\n)\r\n\n'})}),"\n",(0,r.jsx)(n.p,{children:"T\u1ea1o data_collator \u0111\u1ec3 \u0111\u1ea3m b\u1ea3o c\xe1c batch c\u1ee7a d\u1eef li\u1ec7u lu\xf4n \u0111\u01b0\u1ee3c \u0111i\u1ec1n padding"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"data_collator = DataCollatorWithPadding(tokenizer)\n"})}),"\n",(0,r.jsx)(n.p,{children:"Hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh"}),"\n",(0,r.jsxs)(n.p,{children:["N\u1ebfu b\u1ea1n mu\u1ed1n \u0111\u1ecbnh ngh\u0129a th\xeam metrics \u0111\xe1nh gi\xe1 th\xec t\u1ea1o th\xeam function ",(0,r.jsx)(n.code,{children:"compute_metrics"})]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Define Trainer\r\ntrainer = Trainer(\r\n    model=model,\r\n    args=training_args,\r\n    train_dataset=tokenized_train_dataset,\r\n    eval_dataset=tokenized_eval_dataset,\r\n    tokenizer=tokenizer,\r\n    data_collator=data_collator,\r\n    #compute_metrics=compute_metrics\r\n)\r\n\r\n# Train the model\r\ntrainer.train()\n"})})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>c});var r=t(6540);const a={},i=r.createContext(a);function s(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);