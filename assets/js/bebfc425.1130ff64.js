"use strict";(self.webpackChunkdsd_project=self.webpackChunkdsd_project||[]).push([[9162],{4961:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>a,contentTitle:()=>t,default:()=>i,frontMatter:()=>l,metadata:()=>d,toc:()=>h});var c=r(4848),s=r(8453);const l={},t="Apply Function",d={id:"kungfupandas/Loop/Apply_Function",title:"Apply Function",description:"S\u1eed d\u1ee5ng apply",source:"@site/docs/kungfupandas/05-Loop/02-Apply_Function.mdx",sourceDirName:"kungfupandas/05-Loop",slug:"/kungfupandas/Loop/Apply_Function",permalink:"/docs/kungfupandas/Loop/Apply_Function",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{},sidebar:"kungfupandasSidebar",previous:{title:"Vectorization",permalink:"/docs/kungfupandas/Loop/Vectorization"},next:{title:"S\u1eed d\u1ee5ng iterator",permalink:"/docs/kungfupandas/Loop/Iterator"}},a={},h=[{value:"S\u1eed d\u1ee5ng apply",id:"s\u1eed-d\u1ee5ng-apply",level:2},{value:"S\u1eed d\u1ee5ng apply l\xean Series",id:"s\u1eed-d\u1ee5ng-apply-l\xean-series",level:3},{value:"S\u1eed d\u1ee5ng apply l\xean <code>DataFrame</code>",id:"s\u1eed-d\u1ee5ng-apply-l\xean-dataframe",level:3}];function p(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.h1,{id:"apply-function",children:"Apply Function"}),"\n",(0,c.jsx)(e.h2,{id:"s\u1eed-d\u1ee5ng-apply",children:"S\u1eed d\u1ee5ng apply"}),"\n",(0,c.jsxs)(e.p,{children:["Ph\u01b0\u01a1ng th\u1ee9c ",(0,c.jsx)(e.code,{children:"apply"})," \u0111\u1ec3 th\u1ef1c thi m\u1ed9t h\xe0m theo d\xf2ng ho\u1eb7c c\u1ed9t"]}),"\n",(0,c.jsx)(e.h3,{id:"s\u1eed-d\u1ee5ng-apply-l\xean-series",children:"S\u1eed d\u1ee5ng apply l\xean Series"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"Series.apply(func, convert_dtype=True, args=(), **kwargs)\n"})}),"\n",(0,c.jsx)(e.p,{children:"Trong \u0111\xf3:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"func"}),": l\xe0 h\xe0m c\u1ea7n th\u1ef1c thi"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"convert_dtype"}),": Gi\xe1 tr\u1ecb ki\u1ec3u boolean. N\u1ebfu n\xf3 \u0111\u01b0\u1ee3c \u0111\u1eb7t th\xe0nh True (m\u1eb7c \u0111\u1ecbnh), x\u1eed l\xfd d\u1eef li\u1ec7u s\u1ebd c\u1ed1 g\u1eafng t\xecm dtype t\u1ed1t h\u01a1n cho c\xe1c k\u1ebft qu\u1ea3 c\u1ee7a h\xe0m ",(0,c.jsx)(e.code,{children:"func"}),". N\u1ebfu ",(0,c.jsx)(e.code,{children:"False"}),", th\xec dtype s\u1ebd l\xe0 type(object)"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"args"}),": C\xe1c \u0111\u1ed1i s\u1ed1 c\u1ee7a h\xe0m"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.p,{children:["V\xed d\u1ee5, thao t\xe1c ",(0,c.jsx)(e.code,{children:"Item_Outlet_Sales"})," * ",(0,c.jsx)(e.code,{children:"5%"})]}),"\n",(0,c.jsx)(e.p,{children:"S\u1eed d\u1ee5ng lambda function"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"df['Item_Outlet_Sales'].apply(lambda x: x * 0.05)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"0       186.75690\r\n1        22.17114\r\n2       104.86350\r\n3        36.61900\r\n4        49.73526\r\n          ...    \r\n8518    138.91917\r\n8519     27.46425\r\n8520     59.65568\r\n8521     92.27988\r\n8522     38.28350\r\nName: Item_Outlet_Sales, Length: 8523, dtype: float64\n"})}),"\n",(0,c.jsx)(e.p,{children:"S\u1eed d\u1ee5ng h\xe0m t\u1ef1 \u0111\u1ecbnh ngh\u0129a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"def set_price(x, k=0.05):\r\n    return x * k\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"df['Item_Outlet_Sales'].apply(set_price)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"0       186.75690\r\n1        22.17114\r\n2       104.86350\r\n3        36.61900\r\n4        49.73526\r\n          ...    \r\n8518    138.91917\r\n8519     27.46425\r\n8520     59.65568\r\n8521     92.27988\r\n8522     38.28350\r\nName: Item_Outlet_Sales, Length: 8523, dtype: float64\n"})}),"\n",(0,c.jsxs)(e.p,{children:["C\xf3 th\u1ec3 truy\u1ec1n tham s\u1ed1 ",(0,c.jsx)(e.code,{children:"k"})," v\xe0o h\xe0m ",(0,c.jsx)(e.code,{children:"set_price"})," b\u1eb1ng hai c\xe1ch"]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"# C\xe1ch 1 - D\xf9ng lambda\r\ndf['Item_Outlet_Sales'].apply(lambda x: set_price(x, 0.1))\r\n\r\n# C\xe1ch 2 - D\xf9ng `arg`\r\ndf['Item_Outlet_Sales'].apply(set_price, k=0.1)\n"})}),"\n",(0,c.jsxs)(e.h3,{id:"s\u1eed-d\u1ee5ng-apply-l\xean-dataframe",children:["S\u1eed d\u1ee5ng apply l\xean ",(0,c.jsx)(e.code,{children:"DataFrame"})]}),"\n",(0,c.jsx)(e.p,{children:"Ta d\xf9ng c\xfa ph\xe1p"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"DataFrame.apply(func, axis=0, raw=False, result_type=None, args=(), **kwargs)\n"})}),"\n",(0,c.jsx)(e.p,{children:"Trong \u0111\xf3:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"func"}),": l\xe0 h\xe0m c\u1ea7n th\u1ef1c thi"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"axis"}),": th\u1ef1c thi theo d\xf2ng ",(0,c.jsx)(e.code,{children:"0"})," ho\u1eb7c c\u1ed9t ",(0,c.jsx)(e.code,{children:"1"})]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"raw"}),": X\xe1c \u0111\u1ecbnh xem d\xf2ng ho\u1eb7c c\u1ed9t c\xf3 th\u1ec3 chuy\u1ec3n v\u1ec1 ",(0,c.jsx)(e.code,{children:"Series"})," ho\u1eb7c ",(0,c.jsx)(e.code,{children:"ndarray"})]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"result_type"}),": Ch\u1ec9 \xe1p d\u1ee5ng cho ",(0,c.jsx)(e.code,{children:"axis=1"})]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:[(0,c.jsx)(e.code,{children:"args"}),": C\xe1c \u0111\u1ed1i s\u1ed1 c\u1ee7a h\xe0m"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.p,{children:"V\xed d\u1ee5:"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"sample_df = sample_df = pd.DataFrame([[1, 2, 'A'], [3, 6, 'B'], [5, 10, 'C']], columns=['A', 'B', 'C'])\r\nsample_df\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"   A   B  C\r\n0  1   2  A\r\n1  3   6  B\r\n2  5  10  C\n"})}),"\n",(0,c.jsxs)(e.p,{children:["\xc1p d\u1ee5ng tr\xean to\xe0n ",(0,c.jsx)(e.code,{children:"DataFrame"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"sample_df.apply(lambda x: x * 2)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"     A\t B\t C\r\n0\t 2\t 4\tAA\r\n1\t 6\t12\tBB\r\n2\t10\t20\tCC\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{block2,",metastring:"type='rmdnote'}",children:"**_L\u01b0u \xfd:_** \r\n\r\nKhi \xe1p d\u1ee5ng cho to\xe0n `DataFrame` h\xe3y c\u1ea9n th\u1eadn h\xe0m `func` truy\u1ec1n v\xe0o, n\u1ebfu `func` kh\xf4ng \xe1p d\u1ee5ng \u0111\u01b0\u1ee3c cho to\xe0n b\u1ed9 c\xe1c ph\u1ea7n t\u1eed s\u1ebd b\xe1o l\u1ed7i.\r\n\r\nV\xed d\u1ee5 \u1edf tr\xean v\u1edbi x * 2 v\u1eabn \xe1p d\u1ee5ng \u0111\u01b0\u1ee3c cho c\u1ed9t `C` d\u1ea1ng `str`, nh\u01b0ng khi thay b\u1eb1ng x ** 2 s\u1ebd b\xe1o l\u1ed7i v\xec to\xe1n t\u1eed `**` kh\xf4ng \xe1p d\u1ee5ng cho `str` \n"})}),"\n",(0,c.jsxs)(e.p,{children:["\xc1p d\u1ee5ng tr\xean m\u1ed9t s\u1ed1 c\u1ed9t trong ",(0,c.jsx)(e.code,{children:"DataFrame"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-Python",children:"## Theo c\u1ed9t\r\nsample_df[['A', 'B']].apply(np.sum, axis=1)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"0    13\r\n1    13\r\n2    13\r\ndtype: int64\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"## Theo d\xf2ng\r\ndf[['A', 'B']].apply(lambda x: np.sum(x), axis=0)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"A    12\r\nB    27\r\ndtype: int64\n"})}),"\n",(0,c.jsxs)(e.p,{children:["M\u1ed9t c\xe1ch kh\xe1c \xe1p d\u1ee5ng tr\xean m\u1ed9t s\u1ed1 c\u1ed9t trong ",(0,c.jsx)(e.code,{children:"DataFrame"})]}),"\n",(0,c.jsx)(e.p,{children:"S\u1eed d\u1ee5ng lambda"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"sample_df.apply(lambda x: x['A'] + 2 * x['B'], axis=1)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"0     5\r\n1    15\r\n2    25\r\ndtype: int64\n"})}),"\n",(0,c.jsx)(e.p,{children:"D\xf9ng h\xe0m \u0111\u1ecbnh ngh\u0129a"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"def dsum(row):\r\n    return row['A'] + 2 * row['B']\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"sample_df.apply(dsum, axis=1)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"0     5\r\n1    15\r\n2    25\r\ndtype: int64\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{block2,",metastring:"type='rmdtip'}",children:"**_M\u1eb9o:_**\r\n\r\n- Kh\xf4ng nh\u1ea5t thi\u1ebft gi\xe1 tr\u1ecb tr\u1ea3 v\u1ec1 c\u1ee7a h\xe0m l\xe0 gi\xe1 tr\u1ecb \u0111\u01a1n, gi\xe1 tr\u1ecb tr\u1ea3 v\u1ec1 c\xf3 th\u1ec3 d\u01b0\u1edbi d\u1ea1ng list, tuple ho\u1eb7c dict\r\n\r\n- D\xf9ng `result_type` \u0111\u1ec3 thay \u0111\u1ed5i c\xe1ch tr\u1ea3 v\u1ec1\n"})}),"\n",(0,c.jsx)(e.p,{children:"V\xed d\u1ee5 ta c\xf3 1 h\xe0m tr\u1ea3 v\u1ec1 nhi\u1ec1u gi\xe1 tr\u1ecb c\xf9ng l\xfac nh\u01b0 sau"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"def dsum_2(row):\r\n    return [row['A'] + 2 * row['B'],  row['A'] - 2 * row['B']]\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"## Khi kh\xf4ng s\u1eed d\u1ee5ng `result_type`\r\nsample_df.apply(dsum_2, axis=1)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"0      [5, -3]\r\n1     [15, -9]\r\n2    [25, -15]\r\ndtype: object\n"})}),"\n",(0,c.jsxs)(e.p,{children:["K\u1ebft qu\u1ea3 tr\u1ea3 v\u1ec1 c\u1ee7a ph\u01b0\u01a1ng ph\xe1p tr\xean l\xe0 ",(0,c.jsx)(e.code,{children:"Series"})," v\u1edbi c\xe1c gi\xe1 tr\u1ecb c\u1ee7a n\xf3 l\xe0 d\u1ea1ng list. \u0110\u1ec3 chuy\u1ec3n ",(0,c.jsx)(e.code,{children:"Series"})," n\xe0y th\xe0nh ",(0,c.jsx)(e.code,{children:"DataFrame"})," v\u1edbi c\xe1c c\u1ed9t ch\u1ee9a c\xe1c gi\xe1 tr\u1ecb c\u1ee7a list theo th\u1ee9 t\u1ef1, ta d\xf9ng ",(0,c.jsx)(e.code,{children:"result_type='expand'"})]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"sample_df.apply(dsum_2, axis=1, result_type='expand')\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"    0   1\r\n0   5  -3\r\n1  15  -9\r\n2  25 -15\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{block2,",metastring:"type='rmdtip'}",children:"**_M\u1eb9o:_** C\xf3 th\u1ec3 c\u1ea5u tr\xfac tr\u1ea3 v\u1ec1 d\u01b0\u1edbi d\u1ea1ng `DataFrame` cho v\xed d\u1ee5 tr\xean m\xe0 kh\xf4ng c\u1ea7n d\xf9ng `result_type` b\u1eb1ng c\xe1ch s\u1eed d\u1ee5ng `pd.Series` c\u1ee7a m\u1ed9t `dictionary`. L\xfac n\xe0y c\xe1c c\u1ed9t c\u1ee7a `DataFrame` s\u1ebd \u0111\u01b0\u1ee3c \u0111\xe1nh nh\xe3n theo key c\u1ee7a `dictionary`\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"def dsum_3(row):\r\n    return pd.Series({'X': row['A'] + 2 * row['B'],  'Y':row['A'] - 2 * row['B']})\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-python",children:"sample_df.apply(dsum_3, axis=1)\n"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-{.python_output}",children:"\tX\tY\r\n0\t5\t-3\r\n1\t15\t-9\r\n2\t25\t-15\n"})})]})}function i(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(p,{...n})}):p(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>t,x:()=>d});var c=r(6540);const s={},l=c.createContext(s);function t(n){const e=c.useContext(l);return c.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:t(n.components),c.createElement(l.Provider,{value:e},n.children)}}}]);