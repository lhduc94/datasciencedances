"use strict";(self.webpackChunkdsd_project=self.webpackChunkdsd_project||[]).push([[7939],{1987:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>i,frontMatter:()=>a,metadata:()=>p,toc:()=>c});var r=s(4848),l=s(8453);const a={},o="T\u1ed1i \u01b0u h\xf3a t\u1ed1c \u0111\u1ed9 l\u1eb7p",p={id:"kungfupandas/Loop/Compare_Loop_Function",title:"T\u1ed1i \u01b0u h\xf3a t\u1ed1c \u0111\u1ed9 l\u1eb7p",description:"So s\xe1nh c\xe1c ph\u01b0\u01a1ng ph\xe1p l\u1eb7p",source:"@site/docs/kungfupandas/05-Loop/04-Compare_Loop_Function.mdx",sourceDirName:"kungfupandas/05-Loop",slug:"/kungfupandas/Loop/Compare_Loop_Function",permalink:"/docs/kungfupandas/Loop/Compare_Loop_Function",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{},sidebar:"tailieuSidebar",previous:{title:"S\u1eed d\u1ee5ng iterator",permalink:"/docs/kungfupandas/Loop/Iterator"},next:{title:"C\xe1c c\xe1ch ph\u1ed1i h\u1ee3p nhi\u1ec1u b\u1ea3ng",permalink:"/docs/kungfupandas/Merge_Join_Concat/Introduction"}},d={},c=[{value:"So s\xe1nh c\xe1c ph\u01b0\u01a1ng ph\xe1p l\u1eb7p",id:"so-s\xe1nh-c\xe1c-ph\u01b0\u01a1ng-ph\xe1p-l\u1eb7p",level:2},{value:"X\u1eed l\xfd song song trong pandas",id:"x\u1eed-l\xfd-song-song-trong-pandas",level:2},{value:"pandarallel",id:"pandarallel",level:3},{value:"Dask",id:"dask",level:3}];function t(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{id:"t\u1ed1i-\u01b0u-h\xf3a-t\u1ed1c-\u0111\u1ed9-l\u1eb7p",children:"T\u1ed1i \u01b0u h\xf3a t\u1ed1c \u0111\u1ed9 l\u1eb7p"}),"\n",(0,r.jsx)(e.h2,{id:"so-s\xe1nh-c\xe1c-ph\u01b0\u01a1ng-ph\xe1p-l\u1eb7p",children:"So s\xe1nh c\xe1c ph\u01b0\u01a1ng ph\xe1p l\u1eb7p"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"\r\ndef vectorizer(df):\r\n    prices = df['Item_Outlet_Sales'] * 0.5\r\n\r\ndef applyer(df):\r\n    prices = df['Item_Outlet_Sales'].apply(lambda x: x * 0.5)\r\n\r\ndef iterrows(df):\r\n    prices = []\r\n    for i, row in df.iterrows():\r\n        prices.append(row['Item_Outlet_Sales'] * 0.5)\r\n\r\ndef itertuples1(df):\r\n    prices = []\r\n    for row in df.itertuples():\r\n        prices.append(row.Item_Outlet_Sales * 0.5)\r\n\r\ndef itertuples2(df):\r\n    prices = []\r\n    for row in df.itertuples(index=False, name=None):\r\n        prices.append(row[5] * 0.5)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"%timeit -n 10 vectorizer(df)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-{.python_output}",children:"80.1 \xb5s \xb1 42.8 \xb5s per loop (mean \xb1 std. dev. of 7 runs, 10 loops each)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"%timeit -n 10 applyer(df)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-{.python_output}",children:"1.37 ms \xb1 112 \xb5s per loop (mean \xb1 std. dev. of 7 runs, 10 loops each)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"%timeit -n 10 iterrows(df)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-{.python_output}",children:"256 ms \xb1 2.48 ms per loop (mean \xb1 std. dev. of 7 runs, 10 loops each)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"%timeit -n 10 itertuples1(df)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-{.python_output}",children:"6.61 ms \xb1 200 \xb5s per loop (mean \xb1 std. dev. of 7 runs, 10 loops each)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"%timeit -n 10 itertuples2(df)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-{.python_output}",children:"3.91 ms \xb1 132 \xb5s per loop (mean \xb1 std. dev. of 7 runs, 10 loops each)\n"})}),"\n",(0,r.jsx)(e.h2,{id:"x\u1eed-l\xfd-song-song-trong-pandas",children:"X\u1eed l\xfd song song trong pandas"}),"\n",(0,r.jsx)(e.p,{children:"X\u1eed l\xfd song song l\xe0 ph\u01b0\u01a1ng ph\xe1p t\u1eadn d\u1ee5ng s\u1ed1 l\u01b0\u1ee3ng core c\u1ee7a CPU \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 trong th\u1eddi gian ng\u1eafn h\u01a1n."}),"\n",(0,r.jsx)(e.h3,{id:"pandarallel",children:"pandarallel"}),"\n",(0,r.jsxs)(e.p,{children:["\u0110\u1ec3 c\xe0i \u0111\u1eb7t pandarallel b\u1eb1ng ",(0,r.jsx)(e.code,{children:"pip"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"pip install pandarallel\n"})}),"\n",(0,r.jsx)(e.p,{children:"C\xe1ch s\u1eed d\u1ee5ng"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"from pandarallel import pandarallel\r\npandarallel.initialize(progress_bar=True, n_workers=4)\n"})}),"\n",(0,r.jsxs)(e.p,{children:["\u0110\u1ec3 thi\u1ebft l\u1eadp cho pandarallel ta d\xf9ng ",(0,r.jsx)(e.code,{children:".initialize"}),". Trong \u0111\xf3:"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"n_workers"}),": l\xe0 s\u1ed1 l\u01b0\u1ee3ng cores c\u1ee7a CPU"]}),"\n"]}),"\n",(0,r.jsxs)(e.li,{children:["\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.code,{children:"progress_bar"}),": show ti\u1ebfn tr\xecnh"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(e.p,{children:["\u0110\u1ec3 \xe1p d\u1ee5ng pandarallel ta ch\u1ec9 vi\u1ec7c thay th\u1ebf ",(0,r.jsx)(e.code,{children:".apply"})," b\u1eb1ng ",(0,r.jsx)(e.code,{children:".parallel_apply"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# df.apply(func)\r\ndf.parallel_apply(func)\n"})}),"\n",(0,r.jsx)(e.h3,{id:"dask",children:"Dask"}),"\n",(0,r.jsx)(e.p,{children:"Dask l\xe0 m\u1ed9t th\u01b0 vi\u1ec7n t\xednh to\xe1n song song cho Python."}),"\n",(0,r.jsxs)(e.p,{children:["\u0110\u1ec3 c\xe0i \u0111\u1eb7t dask b\u1eb1ng ",(0,r.jsx)(e.code,{children:"pip"})]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"pip install dask\n"})}),"\n",(0,r.jsx)(e.p,{children:"C\xe1ch s\u1eed d\u1ee5ng"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"import dask.dataframe as dd\r\ndd.read_csv('data/big_mart_sales.csv')\n"})})]})}function i(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(t,{...n})}):t(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>o,x:()=>p});var r=s(6540);const l={},a=r.createContext(l);function o(n){const e=r.useContext(a);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function p(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:o(n.components),r.createElement(a.Provider,{value:e},n.children)}}}]);