"use strict";(self.webpackChunkdsd_project=self.webpackChunkdsd_project||[]).push([[7437],{3797:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>m,contentTitle:()=>t,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>c});var a=n(4848),i=n(8453);const l={title:"\u1ee8ng d\u1ee5ng ML Time Series -  D\u1ef1 \u0111o\xe1n b\u0103ng th\xf4ng m\u1ea1ng",slug:"ung-dung-ml-time-series-du-doan-bang-thong-mang",description:"\u1ee8ng d\u1ee5ng ML Time Series - D\u1ef1 \u0111o\xe1n b\u0103ng th\xf4ng m\u1ea1ng",authors:"lhduc",tags:["Data Science"],keywords:["time series","python","ml"],image:"/img/blog/20250301_1_cover.jpg",hide_table_of_contents:!1,draft:!1},t=void 0,r={permalink:"/blog/ung-dung-ml-time-series-du-doan-bang-thong-mang",source:"@site/blog/2025/03/01/bandwidth_prediction.md",title:"\u1ee8ng d\u1ee5ng ML Time Series -  D\u1ef1 \u0111o\xe1n b\u0103ng th\xf4ng m\u1ea1ng",description:"\u1ee8ng d\u1ee5ng ML Time Series - D\u1ef1 \u0111o\xe1n b\u0103ng th\xf4ng m\u1ea1ng",date:"2025-03-01T00:00:00.000Z",formattedDate:"1 th\xe1ng 3, 2025",tags:[{label:"Data Science",permalink:"/blog/tags/data-science"}],readingTime:4.765,hasTruncateMarker:!1,authors:[{name:"L\xea Hu\u1ef3nh \u0110\u1ee9c",title:"Data Scientist",url:"https://www.linkedin.com/in/lhduc94/",imageURL:"https://i.pinimg.com/1200x/94/8c/1d/948c1d9c51227296803919f227eb4cdf.jpg",key:"lhduc"}],frontMatter:{title:"\u1ee8ng d\u1ee5ng ML Time Series -  D\u1ef1 \u0111o\xe1n b\u0103ng th\xf4ng m\u1ea1ng",slug:"ung-dung-ml-time-series-du-doan-bang-thong-mang",description:"\u1ee8ng d\u1ee5ng ML Time Series - D\u1ef1 \u0111o\xe1n b\u0103ng th\xf4ng m\u1ea1ng",authors:"lhduc",tags:["Data Science"],keywords:["time series","python","ml"],image:"/img/blog/20250301_1_cover.jpg",hide_table_of_contents:!1,draft:!1},unlisted:!1,nextItem:{title:"Tomek's Link - Chi\u1ebfn l\u01b0\u1ee3c x\u1eed l\xfd d\u1eef li\u1ec7u m\u1ea5t c\xe2n b\u1eb1ng nh\xe3n",permalink:"/blog/tomek-link-chien-luoc-xu-ly-du-lieu-mat-can-bang-nhan"}},m={authorsImageUrls:[void 0]},c=[{value:"M\xf4 t\u1ea3 b\xe0i to\xe1n",id:"m\xf4-t\u1ea3-b\xe0i-to\xe1n",level:2},{value:"D\u1eef li\u1ec7u",id:"d\u1eef-li\u1ec7u",level:2},{value:"X\u1eed l\xfd d\u1eef li\u1ec7u",id:"x\u1eed-l\xfd-d\u1eef-li\u1ec7u",level:2},{value:"X\xe2y d\u1ef1ng d\u1eef li\u1ec7u training cho Bandwidth",id:"x\xe2y-d\u1ef1ng-d\u1eef-li\u1ec7u-training-cho-bandwidth",level:2},{value:"M\xf4 h\xecnh d\u1ef1 \u0111o\xe1n",id:"m\xf4-h\xecnh-d\u1ef1-\u0111o\xe1n",level:2},{value:"D\u1ef1 \u0111o\xe1n Bandwidth",id:"d\u1ef1-\u0111o\xe1n-bandwidth",level:3},{value:"D\u1ef1 \u0111o\xe1n MAX_USER",id:"d\u1ef1-\u0111o\xe1n-max_user",level:3}];function h(s){const e={a:"a",annotation:"annotation",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mover:"mover",mrow:"mrow",msub:"msub",msubsup:"msubsup",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",ul:"ul",...(0,i.R)(),...s.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.p,{children:(0,a.jsx)(e.img,{src:n(2564).A+"",width:"1024",height:"1024"})}),"\n",(0,a.jsx)(e.h2,{id:"m\xf4-t\u1ea3-b\xe0i-to\xe1n",children:"M\xf4 t\u1ea3 b\xe0i to\xe1n"}),"\n",(0,a.jsx)(e.p,{children:"M\u1ed9t c\xf4ng ty cung c\u1ea5p n\u1ec1n t\u1ea3ng gi\u1ea3i tr\xed cho ph\xe9p user s\u1eed d\u1ee5ng c\xe1c d\u1ecbch v\u1ee5 music, video, live stream, chat, \u2026 H\u1ec7 th\u1ed1ng c\xf4ng ty chia th\xe0nh c\xe1c zone theo khu v\u1ef1c \u0111\u1ecba l\xfd. \u0110\u1ec3 \u0111\xe1p \u1ee9ng s\u1ed1 l\u01b0\u1ee3ng user ng\xe0y c\xe0ng t\u0103ng, c\xf4ng ty mu\u1ed1n d\u1ef1 \u0111o\xe1n \u0111\u01b0\u1ee3c t\u1ed5ng bandwidth c\u1ee7a m\u1ed7i server v\xe0 s\u1ed1 l\u01b0\u1ee3ng t\u1ed1i \u0111a user truy c\u1eadp \u0111\u1ed3ng th\u1eddi v\xe0o server trong v\xf2ng m\u1ed9t th\xe1ng ti\u1ebfp theo \u0111\u1ec3 l\xean k\u1ebf ho\u1ea1ch ho\u1ea1t \u0111\u1ed9ng."}),"\n",(0,a.jsx)(e.h2,{id:"d\u1eef-li\u1ec7u",children:"D\u1eef li\u1ec7u"}),"\n",(0,a.jsxs)(e.p,{children:["D\u1eef li\u1ec7u \u0111\u01b0\u1ee3c m\xf4 t\u1ea3 trong t\u1eadp  ",(0,a.jsx)(e.a,{href:"https://drive.google.com/drive/folders/10dsUuxiMBdWj_NE0GjzXhzKQIZ0KxR0_",children:"train.csv"})]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"UPDATE_TIME,ZONE_CODE,HOUR_ID,BANDWIDTH_TOTAL,MAX_USER\r\n2017-10-01,ZONE01,0,16096.71031272728,212415.0\r\n2017-10-01,ZONE01,1,9374.20790727273,166362.0\r\n2017-10-01,ZONE01,2,5606.225750000003,146370.0\r\n2017-10-01,ZONE01,3,4155.654660909094,141270.0\r\n2017-10-01,ZONE01,4,3253.9785936363623,139689.0\n"})}),"\n",(0,a.jsx)(e.p,{children:"Trong \u0111\xf3:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"UPDATE_TIME: ng\xe0y th\u1ef1c hi\u1ec7n l\u1ea5y d\u1eef li\u1ec7u"}),"\n",(0,a.jsx)(e.li,{children:"HOUR_ID: gi\u1edd th\u1ef1c hi\u1ec7n l\u1ea5y d\u1eef li\u1ec7u"}),"\n",(0,a.jsx)(e.li,{children:"ZONE_CODE: m\xe3 khu v\u1ef1c"}),"\n",(0,a.jsx)(e.li,{children:"BANDWIDTH_TOTAL: t\u1ed5ng b\u0103ng th\xf4ng truy c\u1eadp t\u01b0\u01a1ng \u1ee9ng trong v\xf2ng 1 gi\u1edd"}),"\n",(0,a.jsx)(e.li,{children:"MAX_USER: s\u1ed1 user truy c\u1eadp \u0111\u1ed3ng th\u1eddi t\u1ed1i \u0111a trong v\xf2ng 1 gi\u1edd (l\xe0 m\u1ed9t s\u1ed1 t\u1ef1 nhi\xean)"}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"C\xe1c \u0111\u1ed9i ch\u01a1i c\u1ea7n d\u1ef1 \u0111o\xe1n BANDWIDTH_TOTAL, v\xe0 MAX_USER cho m\u1ed7i d\xf2ng."}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"Metric \u0111\xe1nh gi\xe1"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"S"}),(0,a.jsx)(e.mi,{children:"M"}),(0,a.jsx)(e.mi,{children:"A"}),(0,a.jsx)(e.mi,{children:"P"}),(0,a.jsx)(e.mi,{children:"E"}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsxs)(e.mfrac,{children:[(0,a.jsx)(e.mn,{children:"1"}),(0,a.jsx)(e.mi,{children:"n"})]}),(0,a.jsxs)(e.msubsup,{children:[(0,a.jsx)(e.mo,{children:"\u2211"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"i"}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsx)(e.mn,{children:"1"})]}),(0,a.jsx)(e.mi,{children:"n"})]}),(0,a.jsxs)(e.mfrac,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mi,{children:"i"})]}),(0,a.jsx)(e.mo,{children:"\u2212"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mover,{accent:"true",children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mo,{children:"^"})]}),(0,a.jsx)(e.mi,{children:"i"})]}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"})]}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mi,{children:"i"})]}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsx)(e.mo,{children:"+"}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mover,{accent:"true",children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mo,{children:"^"})]}),(0,a.jsx)(e.mi,{children:"i"})]}),(0,a.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"})]})]}),(0,a.jsx)(e.mo,{children:"\xd7"}),(0,a.jsx)(e.mn,{children:"100"})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"SMAPE = \\frac{1}{n} \\sum_{i=1}^{n} \\frac{|y_i - \\hat{y}_i|}{|y_i| + |\\hat{y}_i|} \\times 100"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"SM"}),(0,a.jsx)(e.span,{className:"mord mathnormal",children:"A"}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.05764em"},children:"PE"}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"1.53em",verticalAlign:"-0.52em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(e.span,{className:"mfrac",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"0.8451em"},children:[(0,a.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"})})})]}),(0,a.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(e.span,{style:{top:"-3.394em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mtight",children:"1"})})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.345em"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(e.span,{className:"mop",children:[(0,a.jsx)(e.span,{className:"mop op-symbol small-op",style:{position:"relative",top:"0em"},children:"\u2211"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"0.8043em"},children:[(0,a.jsxs)(e.span,{style:{top:"-2.4003em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,a.jsx)(e.span,{className:"mrel mtight",children:"="}),(0,a.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]}),(0,a.jsxs)(e.span,{style:{top:"-3.2029em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"})})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2997em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,a.jsx)(e.span,{className:"mfrac",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"1.01em"},children:[(0,a.jsxs)(e.span,{style:{top:"-2.655em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mtight",children:"\u2223"}),(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3281em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"-0.0359em",marginRight:"0.0714em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.143em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mord mtight",children:"\u2223"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"+"}),(0,a.jsx)(e.span,{className:"mord mtight",children:"\u2223"}),(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord accent mtight",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(e.span,{style:{top:"-2.7em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]}),(0,a.jsxs)(e.span,{style:{top:"-2.7em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"accent-body",style:{left:"-0.1944em"},children:(0,a.jsx)(e.span,{className:"mord mtight",children:"^"})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3281em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"-0.0359em",marginRight:"0.0714em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.143em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mord mtight",children:"\u2223"})]})})]}),(0,a.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,a.jsxs)(e.span,{style:{top:"-3.485em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mtight",children:"\u2223"}),(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3281em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"-0.0359em",marginRight:"0.0714em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.143em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord accent mtight",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(e.span,{style:{top:"-2.7em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]}),(0,a.jsxs)(e.span,{style:{top:"-2.7em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"accent-body",style:{left:"-0.1944em"},children:(0,a.jsx)(e.span,{className:"mord mtight",children:"^"})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3281em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"-0.0359em",marginRight:"0.0714em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.143em"},children:(0,a.jsx)(e.span,{})})})]})})]}),(0,a.jsx)(e.span,{className:"mord mtight",children:"\u2223"})]})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.52em"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,a.jsx)(e.span,{className:"mbin",children:"\xd7"}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,a.jsx)(e.span,{className:"mord",children:"100"})]})]})]})}),"\n",(0,a.jsx)(e.p,{children:"Trong \u0111\xf3:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsx)(e.mi,{children:"n"})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"n"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.4306em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",children:"n"})]})})]})," l\xe0 s\u1ed1 l\u01b0\u1ee3ng d\xf2ng d\u1eef li\u1ec7u"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mi,{children:"i"})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"y_i"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})," l\xe0 gi\xe1 tr\u1ecb th\u1ef1c t\u1ebf"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsx)(e.mrow,{children:(0,a.jsxs)(e.msub,{children:[(0,a.jsxs)(e.mover,{accent:"true",children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mo,{children:"^"})]}),(0,a.jsx)(e.mi,{children:"i"})]})}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\hat{y}_i"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord accent",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsxs)(e.span,{className:"vlist",style:{height:"0.6944em"},children:[(0,a.jsxs)(e.span,{style:{top:"-3em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"})]}),(0,a.jsxs)(e.span,{style:{top:"-3em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,a.jsx)(e.span,{className:"accent-body",style:{left:"-0.1944em"},children:(0,a.jsx)(e.span,{className:"mord",children:"^"})})]})]}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.1944em"},children:(0,a.jsx)(e.span,{})})})]})}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})," l\xe0 gi\xe1 tr\u1ecb d\u1ef1 \u0111o\xe1n"]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"D\u01b0\u1edbi \u0111\xe2y l\xe0 code python cho metric \u0111\xe1nh gi\xe1 c\u01a1 b\u1ea3n"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"def smape(y_true, y_pred):\r\n    return np.mean(np.abs(y_true - y_pred) / (np.abs(y_true) + np.abs(y_pred))) * 100\n"})}),"\n",(0,a.jsx)(e.p,{children:"Tuy nhi\xean ch\xfang ta s\u1ebd kh\xf4ng ch\u1ea5m \u0111i\u1ec3m cho tr\u01b0\u1eddng h\u1ee3p gi\xe1 tr\u1ecb th\u1ef1c b\u1eb1ng 0 n\xean metric \u0111\u01b0\u1ee3c \u0111i\u1ec1u ch\u1ec9nh l\u1ea1i nh\u01b0 sau:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"def smape(y_true, y_pred): \r\n    y_true = np.array(y_true)\r\n    y_pred = np.array(y_pred)\r\n    mask = y_true != 0\r\n    return (np.abs(y_true - y_pred)/(np.abs(y_true)+np.abs(y_pred)))[mask].mean()*100\n"})}),"\n",(0,a.jsx)(e.h2,{id:"x\u1eed-l\xfd-d\u1eef-li\u1ec7u",children:"X\u1eed l\xfd d\u1eef li\u1ec7u"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"Load d\u1eef li\u1ec7u"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"import pandas as pd\r\n\r\ntrain_df = pd.read_csv('train.csv')\r\ntest_df = pd.read_csv('test_id.csv')\r\nsub = pd.read_csv('sample_submission.csv')\n"})}),"\n",(0,a.jsx)(e.p,{children:"Lo\u1ea1i b\u1ecf d\u1eef li\u1ec7u tr\xf9ng l\u1eb7p"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"#Drop duplicates and set time index\r\ntrain_df.drop_duplicates(inplace=True)\r\ntrain_df['DATE_TIME'] = train_df['UPDATE_TIME'] + ' ' + (train_df['HOUR_ID'].astype(str)) + ':00:00'\r\ntrain_df['DATE_TIME'] = pd.to_datetime(train_df['DATE_TIME'])\r\ntrain_df.set_index('DATE_TIME',inplace=True)\n"})}),"\n",(0,a.jsx)(e.p,{children:"\u0110\u1ec3 tr\xe1nh missing value, ch\xfang ta s\u1ebd fill missing value. B\u01b0\u1edbc \u0111\u1ea7u ti\xean s\u1ebd t\u1ea1o 1 h\xe0m time \u0111\u1ea7y \u0111\u1ee7 v\u1edbi start l\xe0 ng\xe0y \u0111\u1ea7u ti\xean v\xe0 end l\xe0 ng\xe0y cu\u1ed1i c\xf9ng c\u1ee7a d\u1eef li\u1ec7u."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"def generate_date_time_series(d):\r\n    start = d[0]\r\n    end = d[1]\r\n    step = datetime.timedelta(hours=1)\r\n    result = []\r\n    while start < end:\r\n        result.append(start.strftime('%Y-%m-%d %H:%M:%S'))\r\n        start += step\r\n    result.append(d[1])\r\n    return result\n"})}),"\n",(0,a.jsx)(e.p,{children:"V\u1edbi m\u1ed7i ZoneName m\xecnh ti\u1ebfn h\xe0nh fill missing value cho BANDWIDTH, v\u1ec1 MAX_USER m\xecnh s\u1ebd x\u1eed l\xfd c\xe1ch kh\xe1c. M\u1ed7i v\u1ecb tr\xed b\u1ecb thi\u1ebfu s\u1ebd \u0111\u01b0\u1ee3c \u0111i\u1ec1n b\u1eb1ng trung b\xecnh gi\xe1 tr\u1ecb t\u1ea1i 4 ng\xe0y tr\u01b0\u1edbc. \u1ede \u0111\xe2y m\xecnh c\xf3 set Nlog=True \u0111\u1ec3 chu\u1ea9n h\xf3a d\u1eef li\u1ec7u v\u1ec1 d\u1ea1ng log(N). \u0110\u1ec3 tr\xe1nh b\u1ecb l\u1ed7i log(0) m\xecnh replace nh\u1eefng gi\xe1 tr\u1ecb b\u1eb1ng 0 b\u1eb1ng 0.000003 (\u0111\xe2y l\xe0 gi\xe1 tr\u1ecb nh\u1ecf h\u01a1n gi\xe1 tr\u1ecb min c\u1ee7a BANDWIDTH c\u1ee7a b\xe0i tr\u01b0\u1edbc). C\xe1c b\u1ea1n c\xf3 th\u1ec3 thay th\u1ebf h\xe0m np.log b\u1eb1ng np.log1p m\xe0 kh\xf4ng c\u1ea7n quan t\xe2m t\u1edbi gi\xe1 tr\u1ecb 0."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"t1 = generate_date_time_series(train_df[train_df['ZONE_CODE'] == name].index[[0,-1]])\r\nSERVER = train_df[train_df['ZONE_CODE'] == name]\r\nx = pd.DataFrame({'DATE_TIME':t1, 'BANDWIDTH_TOTAL':np.nan, 'MAX_USER':np.nan})\r\nx['DATE_TIME'] = pd.to_datetime(x['DATE_TIME'])\r\nx.set_index('DATE_TIME', inplace=True)\r\ndf = pd.concat([SERVER[['BANDWIDTH_TOTAL','MAX_USER']],x])\r\ndf1 = df[~df.index.duplicated(keep='first')]\r\ndf1.sort_index(inplace=True)\r\nif Nlog:\r\n    df1.replace(0,0.000003,inplace=True)\r\nTIMESERIAL = df1['BANDWIDTH_TOTAL'].values.copy()\r\nxx = np.argwhere(np.isnan(TIMESERIAL)).flatten()\r\nfor i in xx:\r\n    TIMESERIAL[i] = np.nanmean([ TIMESERIAL[i-24*j] for j in range(1,4)])\r\nif Nlog:\r\n    TIMESERIAL = np.log(TIMESERIAL)\n"})}),"\n",(0,a.jsx)(e.h2,{id:"x\xe2y-d\u1ef1ng-d\u1eef-li\u1ec7u-training-cho-bandwidth",children:"X\xe2y d\u1ef1ng d\u1eef li\u1ec7u training cho Bandwidth"}),"\n",(0,a.jsx)(e.p,{children:"C\xf3 2 c\xe1ch \u0111\u1ec3 x\xe2y d\u1ef1ng d\u1eef li\u1ec7u training:"}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsxs)(e.li,{children:["C\xe1ch 1: Cho chu\u1ed7i th\u1eddi gian seqseq, v\u1edbi m\u1ed7i gi\xe1 tr\u1ecb ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsx)(e.mi,{children:"s"}),(0,a.jsx)(e.mi,{children:"e"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"q"}),(0,a.jsx)(e.mi,{children:"t"})]})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"y=seq_t"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",children:"se"}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2806em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})]})]})," m\xecnh ch\u1ecdn x l\xe0 ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"s"}),(0,a.jsx)(e.mi,{children:"e"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"q"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"t"}),(0,a.jsx)(e.mo,{children:"\u2212"}),(0,a.jsx)(e.mn,{children:"1"}),(0,a.jsx)(e.mo,{children:"\u2212"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"n"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"s"}),(0,a.jsx)(e.mi,{children:"t"}),(0,a.jsx)(e.mi,{children:"e"}),(0,a.jsx)(e.mi,{children:"p"}),(0,a.jsx)(e.mi,{children:"s"})]})]})]})]})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"seq_{t-1-n_{steps}}"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.7779em",verticalAlign:"-0.3473em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",children:"se"}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,a.jsx)(e.span,{className:"mord mtight",children:"1"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2963em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"s"}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"e"}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"}),(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"s"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2819em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3473em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})," \u0111\u1ebfn ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"s"}),(0,a.jsx)(e.mi,{children:"e"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"q"}),(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"t"}),(0,a.jsx)(e.mo,{children:"\u2212"}),(0,a.jsx)(e.mn,{children:"1"})]})]})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"seq_{t-1}"})]})})}),(0,a.jsx)(e.span,{className:"katex-html","aria-hidden":"true",children:(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.6389em",verticalAlign:"-0.2083em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",children:"se"}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsxs)(e.span,{className:"mord mtight",children:[(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"}),(0,a.jsx)(e.span,{className:"mbin mtight",children:"\u2212"}),(0,a.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2083em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})})]})]}),"\n",(0,a.jsxs)(e.li,{children:["C\xe1ch 2: Cho chu\u1ed7i th\u1eddi gian seq, v\u1edbi m\u1ed7i gi\xe1 tr\u1ecb ",(0,a.jsxs)(e.span,{className:"katex",children:[(0,a.jsx)(e.span,{className:"katex-mathml",children:(0,a.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,a.jsxs)(e.semantics,{children:[(0,a.jsxs)(e.mrow,{children:[(0,a.jsx)(e.mi,{children:"y"}),(0,a.jsx)(e.mo,{children:"="}),(0,a.jsx)(e.mi,{children:"s"}),(0,a.jsx)(e.mi,{children:"e"}),(0,a.jsxs)(e.msub,{children:[(0,a.jsx)(e.mi,{children:"q"}),(0,a.jsx)(e.mi,{children:"t"})]})]}),(0,a.jsx)(e.annotation,{encoding:"application/x-tex",children:"y=seq_t"})]})})}),(0,a.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,a.jsx)(e.span,{className:"mrel",children:"="}),(0,a.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,a.jsxs)(e.span,{className:"base",children:[(0,a.jsx)(e.span,{className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,a.jsx)(e.span,{className:"mord mathnormal",children:"se"}),(0,a.jsxs)(e.span,{className:"mord",children:[(0,a.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"q"}),(0,a.jsx)(e.span,{className:"msupsub",children:(0,a.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,a.jsxs)(e.span,{className:"vlist-r",children:[(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.2806em"},children:(0,a.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,a.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,a.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,a.jsx)(e.span,{className:"mord mathnormal mtight",children:"t"})})]})}),(0,a.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,a.jsx)(e.span,{className:"vlist-r",children:(0,a.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,a.jsx)(e.span,{})})})]})})]})]})]})]})," m\xecnh ch\u1ecdn x bao g\u1ed3m c\xe1c gi\xe1 tr\u1ecb c\u1ee7a gi\u1edd \u0111\xf3 nh\u1eefng ng\xe0y h\xf4m tr\u01b0\u1edbc c\xf9ng v\u1edbi mean,min,max c\u1ee7a c\xe1c gi\xe1 tr\u1ecb \u0111\xf3. Ngo\xe0i ra m\xecnh c\xf2n th\xeam v\xe0o 24 gi\xe1 tr\u1ecb g\u1ea7n nh\u1ea5t."]}),"\n"]}),"\n",(0,a.jsx)(e.p,{children:"Code:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"def split_1(sequence, n_steps):\r\n    X, y = list(), list()\r\n    for i in range(len(sequence)):\r\n        end_ix = i + n_steps\r\n        if end_ix > len(sequence)-1:\r\n            break\r\n        seq_x, seq_y = sequence[i:end_ix], sequence[end_ix]\r\n        X.append(seq_x)\r\n        y.append(seq_y)\r\n    \r\n    return np.array(X), np.array(y)\n"})}),"\n",(0,a.jsx)(e.p,{children:"Code cho c\xe1ch 2:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"def split_2(sequence, n_steps):\r\n    a = list(sequence)\r\n    X,y = list(), list()\r\n    for i in reversed(range(len(a))):\r\n        if i == n_steps-1:\r\n            break\r\n        seq_y = a[i]\r\n        seq_x = a[i-n_steps:i:24] + a[i-24:i] \\\r\n                +[np.mean(a[i-n_steps:i:24]),\r\n                  np.min(a[i-n_steps:i:24]),\r\n                  np.max(a[i-n_steps:i:24])]\r\n        X.append(seq_x)\r\n        y.append(seq_y)\r\n    return np.array(X), np.array(y)\n"})}),"\n",(0,a.jsx)(e.h2,{id:"m\xf4-h\xecnh-d\u1ef1-\u0111o\xe1n",children:"M\xf4 h\xecnh d\u1ef1 \u0111o\xe1n"}),"\n",(0,a.jsx)(e.h3,{id:"d\u1ef1-\u0111o\xe1n-bandwidth",children:"D\u1ef1 \u0111o\xe1n Bandwidth"}),"\n",(0,a.jsx)(e.p,{children:"\u0110\u1ed1i v\u1edbi d\u1ef1 \u0111o\xe1n Bandwidth, m\xecnh s\u1ebd s\u1eed d\u1ee5ng m\xf4 h\xecnh Linear Regression, c\u1ee5 th\u1ec3 h\u01a1n l\xe0 Ridge Regression."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"from sklearn.linear_model import Ridge\r\nNlog=True\r\ndef model_1(TIMESERIAL):\r\n    \r\n    train,test = TIMESERIAL[:-24*31],TIMESERIAL[-24*31:]\r\n    n_steps = 24*31\r\n    X, y = split_1(TIMESERIAL,n_steps)\r\n    X_train = X\r\n    y_train = y\r\n    \r\n    model = Ridge()\r\n    model.fit(X_train, y_train)\r\n    pred = model.predict(X_train)\r\n    if Nlog:\r\n        y_train = np.exp(y_train)\r\n        pred = np.exp(pred)\r\n    print(smape(y_train,pred))\r\n    \r\n    bw_pred = []\r\n    for i in range(24*31):\r\n        seq = TIMESERIAL[-n_steps:]\r\n        yhat = model.predict(np.array([seq]))\r\n        TIMESERIAL = np.append(TIMESERIAL,yhat[0])\r\n        bw_pred.append(yhat[0])\r\n    if Nlog:\r\n        bw_pred = np.exp(bw_pred)\r\n        \r\n    return bw_pred\r\ndef model_2(TIMESERIAL):\r\n    \r\n    train,test = TIMESERIAL[:-24*31],TIMESERIAL[-24*31:]\r\n    n_steps = 24*31\r\n    X, y = split_2(TIMESERIAL,n_steps)\r\n    X_train = X\r\n    y_train = y\r\n    \r\n    model = Ridge()\r\n    model.fit(X_train, y_train)\r\n    pred = model.predict(X_train)\r\n    if Nlog:\r\n        y_train = np.exp(y_train)\r\n        pred = np.exp(pred)\r\n    print(smape(y_train,pred))\r\n    \r\n    bw_pred = []\r\n    for j in range(24*31):\r\n        i = len(TIMESERIAL)\r\n        seq = np.append(TIMESERIAL[i-n_steps:i:24],TIMESERIAL[i-24:i])\r\n        seq = np.append(seq,np.array([np.mean(TIMESERIAL[i-n_steps:i:24]),\r\n                  np.min(TIMESERIAL[i-n_steps:i:24]),\r\n                  np.max(TIMESERIAL[i-n_steps:i:24])]\r\n            ))\r\n        yhat = model.predict(np.array([seq]))\r\n        TIMESERIAL = np.append(TIMESERIAL,yhat[0])\r\n        bw_pred.append(yhat[0])\r\n    if Nlog:\r\n        bw_pred = np.exp(bw_pred)\r\n        \r\n    return bw_pred\n"})}),"\n",(0,a.jsx)(e.p,{children:"M\xecnh train v\xe0 predict cho t\u1eebng ZONENAME v\xe0 k\u1ebft h\u1ee3p 2 model l\u1ea1i v\u1edbi nhau theo tham s\u1ed1 [0.67, 0.33]"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"bw_pred_1 = model_1(TIMESERIAL)\r\nbw_pred_2 = model_2(TIMESERIAL)\r\nbw_pred = bw_pred_1*0.67 + bw_pred_2*0.33\n"})}),"\n",(0,a.jsx)(e.h3,{id:"d\u1ef1-\u0111o\xe1n-max_user",children:"D\u1ef1 \u0111o\xe1n MAX_USER"}),"\n",(0,a.jsx)(e.p,{children:"V\u1ec1 MAX_USER m\xecnh kh\xf4ng d\u1ef1 \u0111o\xe1n m\xe0 ch\u1ec9 l\u1ea5y gi\xe1 tr\u1ecb c\u1ee7a ng\xe0y cu\u1ed1i c\xf9ng (\u0111\u1ea7y \u0111\u1ee7 24 gi\xe1 tr\u1ecb) l\xe0m k\u1ebft qu\u1ea3."}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"list_df_2 = []\r\nfor idx,name in enumerate(test_df['ZONE_CODE'].unique()):\r\n    print(idx,name)\r\n    t = pd.DataFrame(train_df[train_df['ZONE_CODE']==name].groupby(['UPDATE_TIME']).size(),columns = ['num_hours'])\r\n    t2 = train_df[(train_df['ZONE_CODE']==name)&(train_df['UPDATE_TIME']==t[t['num_hours']==24].index[-1])]\r\n    list_df_2.append(t2)\r\nmu_df = pd.concat(list_df_2)[['ZONE_CODE','HOUR_ID','MAX_USER']] \r\nmu_df.head()\n"})})]})}function d(s={}){const{wrapper:e}={...(0,i.R)(),...s.components};return e?(0,a.jsx)(e,{...s,children:(0,a.jsx)(h,{...s})}):h(s)}},2564:(s,e,n)=>{n.d(e,{A:()=>a});const a=n.p+"assets/images/cover-d2fc3eb326c7f152943c4cb62c48fe82.jpg"},8453:(s,e,n)=>{n.d(e,{R:()=>t,x:()=>r});var a=n(6540);const i={},l=a.createContext(i);function t(s){const e=a.useContext(l);return a.useMemo((function(){return"function"==typeof s?s(e):{...e,...s}}),[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(i):s.components||i:t(s.components),a.createElement(l.Provider,{value:e},s.children)}}}]);