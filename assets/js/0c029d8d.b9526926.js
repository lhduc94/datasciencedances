"use strict";(self.webpackChunkdsd_project=self.webpackChunkdsd_project||[]).push([[9713],{5021:(n,t,r)=>{r.d(t,{A:()=>i});const i=r.p+"assets/images/batch_size-0533e786a31a253f14bae3116e373d23.png"},6352:(n,t,r)=>{r.d(t,{A:()=>i});const i=r.p+"assets/images/hyperparamters-80ef364677c2a0bc6c5b95920e208bfe.png"},7020:(n,t,r)=>{r.d(t,{A:()=>i});const i=r.p+"assets/images/cover-b42392d1fa445deb6af7f389721bde84.jpg"},8453:(n,t,r)=>{r.d(t,{R:()=>s,x:()=>c});var i=r(6540);const e={},h=i.createContext(e);function s(n){const t=i.useContext(h);return i.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function c(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(e):n.components||e:s(n.components),i.createElement(h.Provider,{value:t},n.children)}},8708:(n,t,r)=>{r.d(t,{A:()=>i});const i=r.p+"assets/images/overfitting_underfitting-6b4ee3df089f627facf87258854d6bcd.png"},9604:(n,t,r)=>{r.r(t),r.d(t,{assets:()=>a,contentTitle:()=>s,default:()=>p,frontMatter:()=>h,metadata:()=>c,toc:()=>d});var i=r(4848),e=r(8453);const h={title:"T\u1ed1i \u01b0u si\xeau tham s\u1ed1 m\xf4 h\xecnh v\u1edbi GridSearchCV",slug:"2025/03/hyperparameter-tuning-gridsearchCV",description:"Trong hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh m\xe1y h\u1ecdc, vi\u1ec7c l\u1ef1a ch\u1ecdn si\xeau tham s\u1ed1 (hyperparameters) \u1ea3nh h\u01b0\u1edfng tr\u1ef1c ti\u1ebfp \u0111\u1ebfn hi\u1ec7u su\u1ea5t c\u1ee7a m\xf4 h\xecnh. Kh\xf4ng gi\u1ed1ng nh\u01b0 tham s\u1ed1 h\u1ecdc \u0111\u01b0\u1ee3c t\u1eeb d\u1eef li\u1ec7u, si\xeau tham s\u1ed1 c\u1ea7n \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp tr\u01b0\u1edbc khi hu\u1ea5n luy\u1ec7n.",authors:"lhduc",tags:["Data Science"],keywords:["data science","hyperparameter tuning","python","ml","si\xeau tham s\u1ed1","machine learning","m\xe1y h\u1ecdc","t\u1ed1i \u01b0u","gridsearchcv"],image:"/img/blog/20250304_1_cover.jpg",hide_table_of_contents:!1,draft:!1},s=void 0,c={permalink:"/blog/2025/03/hyperparameter-tuning-gridsearchCV",source:"@site/blog/2025/03/04/hyperparameter-tuning-gridsearchCV.md",title:"T\u1ed1i \u01b0u si\xeau tham s\u1ed1 m\xf4 h\xecnh v\u1edbi GridSearchCV",description:"Trong hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh m\xe1y h\u1ecdc, vi\u1ec7c l\u1ef1a ch\u1ecdn si\xeau tham s\u1ed1 (hyperparameters) \u1ea3nh h\u01b0\u1edfng tr\u1ef1c ti\u1ebfp \u0111\u1ebfn hi\u1ec7u su\u1ea5t c\u1ee7a m\xf4 h\xecnh. Kh\xf4ng gi\u1ed1ng nh\u01b0 tham s\u1ed1 h\u1ecdc \u0111\u01b0\u1ee3c t\u1eeb d\u1eef li\u1ec7u, si\xeau tham s\u1ed1 c\u1ea7n \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp tr\u01b0\u1edbc khi hu\u1ea5n luy\u1ec7n.",date:"2025-03-04T00:00:00.000Z",formattedDate:"4 th\xe1ng 3, 2025",tags:[{label:"Data Science",permalink:"/blog/tags/data-science"}],readingTime:9.57,hasTruncateMarker:!1,authors:[{name:"L\xea Hu\u1ef3nh \u0110\u1ee9c",title:"Data Scientist",url:"https://www.linkedin.com/in/lhduc94/",imageURL:"https://i.pinimg.com/1200x/94/8c/1d/948c1d9c51227296803919f227eb4cdf.jpg",key:"lhduc"}],frontMatter:{title:"T\u1ed1i \u01b0u si\xeau tham s\u1ed1 m\xf4 h\xecnh v\u1edbi GridSearchCV",slug:"2025/03/hyperparameter-tuning-gridsearchCV",description:"Trong hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh m\xe1y h\u1ecdc, vi\u1ec7c l\u1ef1a ch\u1ecdn si\xeau tham s\u1ed1 (hyperparameters) \u1ea3nh h\u01b0\u1edfng tr\u1ef1c ti\u1ebfp \u0111\u1ebfn hi\u1ec7u su\u1ea5t c\u1ee7a m\xf4 h\xecnh. Kh\xf4ng gi\u1ed1ng nh\u01b0 tham s\u1ed1 h\u1ecdc \u0111\u01b0\u1ee3c t\u1eeb d\u1eef li\u1ec7u, si\xeau tham s\u1ed1 c\u1ea7n \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp tr\u01b0\u1edbc khi hu\u1ea5n luy\u1ec7n.",authors:"lhduc",tags:["Data Science"],keywords:["data science","hyperparameter tuning","python","ml","si\xeau tham s\u1ed1","machine learning","m\xe1y h\u1ecdc","t\u1ed1i \u01b0u","gridsearchcv"],image:"/img/blog/20250304_1_cover.jpg",hide_table_of_contents:!1,draft:!1},unlisted:!1,prevItem:{title:"T\u1ed1i \u01b0u si\xeau tham s\u1ed1 m\xf4 h\xecnh v\u1edbi RandomizedSearchCV",permalink:"/blog/2025/03/hyperparameter-tuning-RandomizedSearchCV"},nextItem:{title:"Ph\xe2n t\xedch hi\u1ec7u su\u1ea5t v\u1edbi Data Envelopment Analysis",permalink:"/blog/2024/08/data-envelopment-analysis-phan-tich-hieu-suat"}},a={authorsImageUrls:[void 0]},d=[{value:"Gi\u1edbi thi\u1ec7u",id:"gi\u1edbi-thi\u1ec7u",level:2},{value:"Hyperparameter l\xe0 g\xec?",id:"hyperparameter-l\xe0-g\xec",level:2},{value:"T\u1ea1i sao c\u1ea7n Hyperparameter Tuning?",id:"t\u1ea1i-sao-c\u1ea7n-hyperparameter-tuning",level:2},{value:"Tr\xe1nh overfitting v\xe0 underfitting",id:"tr\xe1nh-overfitting-v\xe0-underfitting",level:3},{value:"T\u1ed1i \u01b0u h\xf3a th\u1eddi gian v\xe0 t\xe0i nguy\xean",id:"t\u1ed1i-\u01b0u-h\xf3a-th\u1eddi-gian-v\xe0-t\xe0i-nguy\xean",level:3},{value:"Gi\u1ea3m chi ph\xed t\xednh to\xe1n",id:"gi\u1ea3m-chi-ph\xed-t\xednh-to\xe1n",level:3},{value:"C\xe1c ph\u01b0\u01a1ng ph\xe1p Hyperparameter Tuning",id:"c\xe1c-ph\u01b0\u01a1ng-ph\xe1p-hyperparameter-tuning",level:2},{value:"Grid Search",id:"grid-search",level:3},{value:"GridSearchCV",id:"gridsearchcv",level:3}];function l(n){const t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,e.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:r(7020).A+"",width:"1024",height:"1024"})}),"\n",(0,i.jsx)(t.h2,{id:"gi\u1edbi-thi\u1ec7u",children:"Gi\u1edbi thi\u1ec7u"}),"\n",(0,i.jsx)(t.p,{children:"Trong hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh m\xe1y h\u1ecdc, vi\u1ec7c l\u1ef1a ch\u1ecdn si\xeau tham s\u1ed1 (hyperparameters) \u1ea3nh h\u01b0\u1edfng tr\u1ef1c ti\u1ebfp \u0111\u1ebfn hi\u1ec7u su\u1ea5t c\u1ee7a m\xf4 h\xecnh.\r\nKh\xf4ng gi\u1ed1ng nh\u01b0 tham s\u1ed1 h\u1ecdc \u0111\u01b0\u1ee3c t\u1eeb d\u1eef li\u1ec7u, si\xeau tham s\u1ed1 c\u1ea7n \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp tr\u01b0\u1edbc khi hu\u1ea5n luy\u1ec7n.\r\nHyperparameter Tuning l\xe0 qu\xe1 tr\xecnh t\xecm ki\u1ebfm gi\xe1 tr\u1ecb t\u1ed1i \u01b0u \u0111\u1ec3 m\xf4 h\xecnh ho\u1ea1t \u0111\u1ed9ng t\u1ed1t nh\u1ea5t.\r\nVi\u1ec7c n\xe0y gi\xfap c\u1ea3i thi\u1ec7n \u0111\u1ed9 ch\xednh x\xe1c, tr\xe1nh overfitting v\xe0 underfitting."}),"\n",(0,i.jsx)(t.p,{children:"Trong n\u1ed9i dung b\xe0i vi\u1ebft n\xe0y, m\xecnh s\u1ebd gi\u1edbi thi\u1ec7u v\u1ec1 ph\u01b0\u01a1ng ph\xe1p c\u01a1 b\u1ea3n nh\u1ea5t \u0111\u1ec3 t\u1ed1i \u01b0u si\xeau tham s\u1ed1 l\xe0 GridSearchCV."}),"\n",(0,i.jsx)(t.h2,{id:"hyperparameter-l\xe0-g\xec",children:"Hyperparameter l\xe0 g\xec?"}),"\n",(0,i.jsx)(t.p,{children:"\u0110\u1ea7u ti\xean, ch\xfang ta c\u1ea7n bi\u1ebft \u0111\u1ecbnh ngh\u0129a Hyperparamter l\xe0 g\xec. Theo ngh\u0129a ti\u1ebfng Vi\u1ec7t th\xec hyperparameter ngh\u0129a l\xe0 si\xeau tham s\u1ed1 \u0111\u01b0\u1ee3c c\xe0i \u0111\u1eb7t tr\u01b0\u1edbc khi qu\xe1 tr\xecnh hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh b\u1eaft \u0111\u1ea7u. Kh\xe1c v\u1edbi c\xe1c parameter th\xf4ng th\u01b0\u1eddng \u0111\u01b0\u1ee3c h\u1ecdc trong qu\xe1 tr\xecnh training, hyperparameter c\u1ea7n \u0111\u01b0\u1ee3c thi\u1ebft l\u1eadp b\u1edfi ng\u01b0\u1eddi l\u1eadp tr\xecnh v\xe0 \u1ea3nh h\u01b0\u1edfng tr\u1ef1c ti\u1ebfp \u0111\u1ebfn hi\u1ec7u qu\u1ea3 c\u1ee7a m\xf4 h\xecnh."}),"\n",(0,i.jsx)("figure",{children:(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.img,{src:r(6352).A+"",width:"942",height:"163"}),"\r\n",(0,i.jsx)("figcaption",{children:"Hyperparameter trong DecisionTreeClassifer"})]})}),"\n",(0,i.jsx)(t.p,{children:"M\u1ed9t s\u1ed1 hyperparameter ph\u1ed5 bi\u1ebfn:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\u0110\u1ed9 s\xe2u c\u1ee7a c\xe2y (",(0,i.jsx)(t.em,{children:"max_depth"}),") trong ",(0,i.jsx)(t.strong,{children:"DecisionTree"})]}),"\n",(0,i.jsxs)(t.li,{children:["S\u1ed1 l\u01b0\u1ee3ng c\xe2y ",(0,i.jsx)(t.code,{children:"n_estimators"})," trong ",(0,i.jsx)(t.strong,{children:"RandomForest"})]}),"\n",(0,i.jsxs)(t.li,{children:["Learning rate (",(0,i.jsx)(t.em,{children:"eta"}),", ",(0,i.jsx)(t.em,{children:"learning_rate"}),") trong Gradient Descent"]}),"\n",(0,i.jsxs)(t.li,{children:["H\u1ec7 s\u1ed1 regularization nh\u01b0  ",(0,i.jsx)(t.em,{children:"alpha"})," trong ",(0,i.jsx)(t.strong,{children:"Ridge/Lasso"}),", ",(0,i.jsx)(t.em,{children:"C"})," trong ",(0,i.jsx)(t.strong,{children:"SVM"})]}),"\n",(0,i.jsxs)(t.li,{children:["S\u1ed1 l\u1edbp \u1ea9n (",(0,i.jsx)(t.em,{children:"n_layers"}),") v\xe0 s\u1ed1 neuron(",(0,i.jsx)(t.em,{children:"hidden_state"}),") trong m\u1ea1ng neural"]}),"\n",(0,i.jsxs)(t.li,{children:["S\u1ed1 l\u01b0\u1ee3ng d\u1eef li\u1ec7u trong m\u1ed9t batch ",(0,i.jsx)(t.em,{children:"batch_size"})]}),"\n",(0,i.jsxs)(t.li,{children:["C\xe1c ch\u1ec9 ti\xeau \u0111\xe1nh gi\xe1 nh\u01b0 ",(0,i.jsx)(t.em,{children:"criterion"})," trong DecisionTree\r\n..."]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"t\u1ea1i-sao-c\u1ea7n-hyperparameter-tuning",children:"T\u1ea1i sao c\u1ea7n Hyperparameter Tuning?"}),"\n",(0,i.jsx)(t.h3,{id:"tr\xe1nh-overfitting-v\xe0-underfitting",children:"Tr\xe1nh overfitting v\xe0 underfitting"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"Overfitting"})," x\u1ea3y ra khi m\xf4 h\xecnh h\u1ecdc qu\xe1 kh\u1edbp v\u1edbi d\u1eef li\u1ec7u hu\u1ea5n luy\u1ec7n nh\u01b0ng kh\xf4ng t\u1ed5ng qu\xe1t h\xf3a \u0111\u01b0\u1ee3c v\u1edbi d\u1eef li\u1ec7u m\u1edbi. Trong khi ",(0,i.jsx)(t.strong,{children:"Underfitting"})," x\u1ea3y ra khi m\xf4 h\xecnh qu\xe1 \u0111\u01a1n gi\u1ea3n v\xe0 kh\xf4ng n\u1eafm b\u1eaft \u0111\u01b0\u1ee3c c\xe1c m\u1eabu trong d\u1eef li\u1ec7u. Vi\u1ec7c tinh ch\u1ec9nh si\xeau tham s\u1ed1 gi\xfap c\xe2n b\u1eb1ng gi\u1eefa hai v\u1ea5n \u0111\u1ec1 n\xe0y, \u0111\u1ea3m b\u1ea3o m\xf4 h\xecnh t\u1ed5ng qu\xe1t h\xf3a t\u1ed1t."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:r(8708).A+"",width:"1489",height:"490"})}),"\n",(0,i.jsxs)(t.p,{children:["H\xecnh tr\xean l\xe0 h\xecnh minh h\u1ecda Decision Tree v\u1edbi 3 c\xe1ch l\u1ef1a ch\u1ecdn si\xeau tham s\u1ed1 ",(0,i.jsx)(t.em,{children:"max_depth"})]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"max_depth=1"}),": Underfitting, m\xf4 h\xecnh qu\xe1 \u0111\u01a1n gi\u1ea3n, kh\xf4ng b\u1eaft \u0111\u01b0\u1ee3c xu h\u01b0\u1edbng d\u1eef li\u1ec7u."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"max_depth=10"}),": Overfitting, m\xf4 h\xecnh qu\xe1 ph\u1ee9c t\u1ea1p, kh\u1edbp ch\u1eb7t v\u1edbi d\u1eef li\u1ec7u hu\u1ea5n luy\u1ec7n nh\u01b0ng c\xf3 th\u1ec3 t\u1ed5ng qu\xe1t h\xf3a k\xe9m."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"max_depth=4"}),": Optimal, m\xf4 h\xecnh c\xe2n b\u1eb1ng gi\u1eefa \u0111\u01a1n gi\u1ea3n v\xe0 ph\u1ee9c t\u1ea1p, d\u1ef1 \u0111o\xe1n t\u1ed1t."]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"t\u1ed1i-\u01b0u-h\xf3a-th\u1eddi-gian-v\xe0-t\xe0i-nguy\xean",children:"T\u1ed1i \u01b0u h\xf3a th\u1eddi gian v\xe0 t\xe0i nguy\xean"}),"\n",(0,i.jsxs)(t.p,{children:["M\u1ed9t s\u1ed1 si\xeau tham s\u1ed1 nh\u01b0 k\xedch th\u01b0\u1edbc batch (batch size) ho\u1eb7c s\u1ed1 l\u01b0\u1ee3ng epoch \u1ea3nh h\u01b0\u1edfng \u0111\u1ebfn th\u1eddi gian hu\u1ea5n luy\u1ec7n v\xe0 t\xe0i nguy\xean t\xednh to\xe1n.\r\nTinh ch\u1ec9nh gi\xfap t\xecm ra c\u1ea5u h\xecnh t\u1ed1i \u01b0u \u0111\u1ec3 hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh nhanh h\u01a1n m\xe0 kh\xf4ng l\xe0m gi\u1ea3m hi\u1ec7u su\u1ea5t.\r\n",(0,i.jsx)(t.img,{src:r(5021).A+"",width:"790",height:"490"})]}),"\n",(0,i.jsx)(t.p,{children:"\u0110\xe2y l\xe0 bi\u1ec3u \u0111\u1ed3 minh h\u1ecda \u1ea3nh h\u01b0\u1edfng c\u1ee7a k\xedch th\u01b0\u1edbc batch (Batch Size) \u0111\u1ebfn th\u1eddi gian hu\u1ea5n luy\u1ec7n v\xe0 \u0111\u1ed9 ch\xednh x\xe1c c\u1ee7a m\xf4 h\xecnh:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"\u0110\u01b0\u1eddng m\xe0u \u0111\u1ecf"}),": Th\u1eddi gian hu\u1ea5n luy\u1ec7n gi\u1ea3m khi Batch Size t\u0103ng."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"\u0110\u01b0\u1eddng m\xe0u xanh"}),": \u0110\u1ed9 ch\xednh x\xe1c c\u1ee7a m\xf4 h\xecnh t\u0103ng \u0111\u1ebfn m\u1ed9t m\u1ee9c t\u1ed1i \u01b0u r\u1ed3i b\u1eaft \u0111\u1ea7u gi\u1ea3m nh\u1eb9."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Bi\u1ec3u \u0111\u1ed3 n\xe0y th\u1ec3 hi\u1ec7n r\u1eb1ng vi\u1ec7c t\u1ed1i \u01b0u Batch Size gi\xfap gi\u1ea3m th\u1eddi gian hu\u1ea5n luy\u1ec7n m\xe0 v\u1eabn duy tr\xec hi\u1ec7u su\u1ea5t m\xf4 h\xecnh t\u1ed1t."}),"\n",(0,i.jsx)(t.h3,{id:"gi\u1ea3m-chi-ph\xed-t\xednh-to\xe1n",children:"Gi\u1ea3m chi ph\xed t\xednh to\xe1n"}),"\n",(0,i.jsx)(t.p,{children:"N\u1ebfu ch\xfang ta ch\u1ecdn tham s\u1ed1 kh\xf4ng h\u1ee3p l\xfd, m\xf4 h\xecnh c\xf3 th\u1ec3 m\u1ea5t nhi\u1ec1u th\u1eddi gian \u0111\u1ec3 h\u1ed9i t\u1ee5, \u0111i\u1ec1u n\xe0y d\u1eabn \u0111\u1ebfn t\u0103ng chi ph\xed t\xednh to\xe1n m\xe0 kh\xf4ng c\u1ea3i thi\u1ec7n \u0111\u01b0\u1ee3c hi\u1ec7u su\u1ea5t m\xf4 h\xecnh."}),"\n",(0,i.jsxs)(t.p,{children:["V\xed d\u1ee5 nh\u01b0 ",(0,i.jsx)(t.strong,{children:"grid search"}),", ch\xfang ta c\u1ea7n th\u1eed t\u1ea5t c\u1ea3 c\xe1c t\u1ed5 h\u1ee3p gi\xe1 tr\u1ecb trong kh\xf4ng gian t\xecm ki\u1ebfm, \u0111i\u1ec1u n\xe0y c\xf3 th\u1ec3 t\u1ed1n nhi\u1ec1u th\u1eddi gian v\xe0 t\xe0i nguy\xean."]}),"\n",(0,i.jsxs)(t.p,{children:["Ng\u01b0\u1ee3c l\u1ea1i n\u1ebfu d\xf9ng ",(0,i.jsx)(t.strong,{children:"random search"})," ho\u1eb7c ",(0,i.jsx)(t.strong,{children:"bayesian optimization"}),", ch\xfang ta c\xf3 th\u1ec3 gi\u1ea3m \u0111\u01b0\u1ee3c s\u1ed1 l\u1ea7n th\u1eed nghi\u1ec7m v\xe0 t\xe0i nguy\xean t\xednh to\xe1n. Do \u0111\xf3, vi\u1ec7c t\u1ed1i \u01b0u si\xeau tham s\u1ed1 gi\xfap ti\u1ebft ki\u1ec7m chi ph\xed t\xednh to\xe1n."]}),"\n",(0,i.jsx)(t.h2,{id:"c\xe1c-ph\u01b0\u01a1ng-ph\xe1p-hyperparameter-tuning",children:"C\xe1c ph\u01b0\u01a1ng ph\xe1p Hyperparameter Tuning"}),"\n",(0,i.jsx)(t.h3,{id:"grid-search",children:"Grid Search"}),"\n",(0,i.jsx)(t.p,{children:"Grid search l\xe0 ph\u01b0\u01a1ng ph\xe1p t\u1ed1i \u01b0u si\xeau tham s\u1ed1 b\u1eb1ng c\xe1ch th\u1eed t\u1ea5t c\u1ea3 c\xe1c t\u1ed5 h\u1ee3p gi\xe1 tr\u1ecb trong kh\xf4ng gian t\xecm ki\u1ebfm.\r\nV\xed d\u1ee5 n\u1ebfu b\u1ea1n c\xf3 2 si\xeau tham s\u1ed1"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"max_depth"})," v\u1edbi c\xe1c gi\xe1 tr\u1ecb nguy\xean trong danh s\xe1ch [4,5,6]"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.em,{children:"n_estimators"})," v\u1edbi c\xe1c gi\xe1 tr\u1ecb nguy\xean trong danh s\xe1ch [10,20,30]"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Th\xec grid search s\u1ebd th\u1eed t\u1ea5t c\u1ea3 c\xe1c t\u1ed5 h\u1ee3p gi\xe1 tr\u1ecb trong kh\xf4ng gian t\xecm ki\u1ebfm nh\u01b0"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.em,{children:"max_depth=4, n_estimators=10"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.em,{children:"max_depth=4, n_estimators=20"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.em,{children:"max_depth=4, n_estimators=30"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.em,{children:"max_depth=5, n_estimators=10"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.em,{children:"max_depth=5, n_estimators=20"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.em,{children:"max_depth=5, n_estimators=30"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.em,{children:"max_depth=6, n_estimators=10"})}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"Sau \u0111\xf3 ch\u1ecdn ra t\u1ed5 h\u1ee3p c\xf3 hi\u1ec7u su\u1ea5t t\u1ed1t nh\u1ea5t."}),"\n",(0,i.jsx)(t.p,{children:"\u01afu \u0111i\u1ec3m c\u1ee7a ph\u01b0\u01a1ng ph\xe1p n\xe0y l\xe0 \u0111\u01a1n gi\u1ea3n v\xe0 d\u1ec5 th\u1ef1c hi\u1ec7n tuy nhi\xean nh\u01b0\u1ee3c \u0111i\u1ec3m l\xe0 t\u1ed1n th\u1eddi gian v\u1edbi kh\xf4ng gian l\u1edbn. Gi\u1ea3 s\u1eed ch\xfang ta c\xf3 nhi\u1ec1u h\u01a1n 2 si\xeau tham s\u1ed1, v\xed d\u1ee5 3 si\xeau tham s\u1ed1, m\u1ed7i tham s\u1ed1 v\u1edbi 5 gi\xe1 tr\u1ecb kh\xe1c nhau, th\xec s\u1ebd c\xf3 5^3 = 125 t\u1ed5 h\u1ee3p."}),"\n",(0,i.jsxs)(t.p,{children:["D\u01b0\u1edbi \u0111\xe2y l\xe0 v\xed d\u1ee5 code python cho Grid Search \u0111\u01a1n gi\u1ea3n. M\xecnh s\u1ebd d\xf9ng b\u1ed9 d\u1eef li\u1ec7u ",(0,i.jsx)(t.a,{href:"https://archive.ics.uci.edu/dataset/327/phishing+websites",children:"Phishing Websites"}),". B\u1ed9 d\u1eef li\u1ec7u n\xe0y ch\u1ec9 ch\u1ee9a c\xe1c feature thu\u1ed9c numerical."]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Chu\u1ea9n b\u1ecb d\u1eef li\u1ec7u"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'from sklearn.model_selection import train_test_split\r\nfrom ucimlrepo import fetch_ucirepo \r\nfrom sklearn.ensemble import RandomForestClassifier\r\nfrom sklearn.metrics import accuracy_score\r\n\r\n# fetch dataset \r\nphishing_websites = fetch_ucirepo(id=327) \r\n  \r\n# data (as pandas dataframes) \r\nX = phishing_websites.data.features \r\ny = phishing_websites.data.targets\r\n\r\n\r\n# Chia t\u1eadp train v\xe0 test\r\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)\r\n\r\n# Chia t\u1eadp train v\xe0 valid\r\nX_train, X_valid, y_train, y_valid = train_test_split(X_train, y_train, test_size=0.25, random_state=42, stratify=y_train)\r\n\r\n# Ki\u1ec3m tra k\xedch th\u01b0\u1edbc d\u1eef li\u1ec7u\r\nprint(f"Train size: {X_train.shape}, Valid size: {X_valid.shape}, Test size: {X_test.shape}")\n'})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Train size: (6633, 30), Valid size: (2211, 30), Test size: (2211, 30)\n"})})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"T\u1ea1o t\u1ea5t c\u1ea3 c\xe1c t\u1ed5 h\u1ee3p tham s\u1ed1 c\xf3 th\u1ec3 c\xf3"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"import itertools\r\n\r\nparam_grid = {\r\n    'n_estimators': [50, 100, 200],  \r\n    'max_depth': [3, 5, 10],\r\n}\r\n\r\n# T\u1ea1o t\u1ea5t c\u1ea3 c\xe1c t\u1ed5 h\u1ee3p tham s\u1ed1 c\xf3 th\u1ec3 c\xf3\r\nparam_combinations = list(itertools.product(*param_grid.values()))\r\nfor params in param_combinations:\r\n    print(f'n_estimators: {params[0]}, \\t max_depth: {params[1]}')\r\n\n"})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"n_estimators: 50, \t max_depth: 3\r\nn_estimators: 50, \t max_depth: 5\r\nn_estimators: 50, \t max_depth: 10\r\nn_estimators: 100, \t max_depth: 3\r\nn_estimators: 100, \t max_depth: 5\r\nn_estimators: 100, \t max_depth: 10\r\nn_estimators: 200, \t max_depth: 3\r\nn_estimators: 200, \t max_depth: 5\r\nn_estimators: 200, \t max_depth: 10\n"})})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Hu\u1ea5n luy\u1ec7n m\xf4 h\xecnh v\u1edbi t\u1eebng t\u1ed5 h\u1ee3p tham s\u1ed1"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'# L\u01b0u k\u1ebft qu\u1ea3\r\nbest_score = 0\r\nbest_params = None\r\nbest_model = None\r\n\r\n# Th\u1eed t\u1eebng b\u1ed9 tham s\u1ed1\r\nfor params in param_combinations:\r\n    param_dict = dict(zip(param_grid.keys(), params))\r\n    \r\n    # Train model\r\n    model = RandomForestClassifier(**param_dict, random_state=42)\r\n    model.fit(X_train, y_train)\r\n    \r\n    # D\u1ef1 \u0111o\xe1n v\xe0 \u0111\xe1nh gi\xe1\r\n    y_pred = model.predict(X_valid)\r\n    accuracy = accuracy_score(y_valid, y_pred)\r\n    \r\n    # L\u01b0u l\u1ea1i b\u1ed9 tham s\u1ed1 t\u1ed1t nh\u1ea5t\r\n    if accuracy > best_score:\r\n        best_score = accuracy\r\n        best_params = param_dict\r\n        best_model = model\r\n\r\n# In k\u1ebft qu\u1ea3 t\u1ed1t nh\u1ea5t\r\nprint("Best Parameters:", best_params)\r\nprint("Best Model Accuracy on Valid Set:", best_score)\n'})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Best Parameters: {'n_estimators': 200, 'max_depth': 10}\r\nBest Model Accuracy on Valid Set: 0.9547715965626413\n"})})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"\u0110\xe1nh gi\xe1 m\xf4 h\xecnh tr\xean t\u1eadp test"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'# D\u1ef1 \u0111o\xe1n v\xe0 \u0111\xe1nh gi\xe1\r\ny_pred = best_model.predict(X_test)\r\naccuracy = accuracy_score(y_test, y_pred)\r\nprint(f"Tuned Model Accuracy on Test Set: {accuracy:.4f}")\n'})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Tuned Model Accuracy on Test Set: 0.9557\n"})})}),"\n",(0,i.jsxs)(t.p,{children:["Ch\xfang ta s\u1ebd so s\xe1nh v\u1edbi m\xf4 h\xecnh v\u1edbi b\u1ed9 tham s\u1ed1 ",(0,i.jsx)(t.code,{children:"n_estimators=50, max_depth=5"})]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'model = RandomForestClassifier( n_estimators=50, max_depth=5, random_state=42)\r\nmodel.fit(X_train, y_train)\r\ny_pred_valid = model.predict(X_valid)\r\naccuracy = accuracy_score(y_valid, y_pred_valid)\r\nprint(f"Model Accuracy on Valid Set: {accuracy:.4f}")\r\ny_pred = model.predict(X_test)\r\naccuracy = accuracy_score(y_test, y_pred)\r\nprint(f"Model Accuracy on Test Set: {accuracy:.4f}")\n'})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Model Accuracy on Valid Set: 0.9326\r\nModel Accuracy on Test Set: 0.9331\n"})})}),"\n",(0,i.jsxs)(t.p,{children:["K\u1ebft qu\u1ea3 cho th\u1ea5y, n\u1ebfu nh\u01b0 ch\xfang ta d\xf9ng gridsearch \u0111\u1ec3 duy\u1ec7t nhi\u1ec1u b\u1ed9 tham s\u1ed1 kh\xe1c nhau, k\u1ebft qu\u1ea3 c\xf3 th\u1ec3 s\u1ebd t\u1ed1t h\u01a1n so v\u1edbi ch\u1ec9 d\xf9ng m\u1ed9t b\u1ed9 tham s\u1ed1 ",(0,i.jsx)(t.em,{children:'"tr\xean tr\u1eddi r\u01a1i xu\u1ed1ng"'})]}),"\n",(0,i.jsx)(t.h3,{id:"gridsearchcv",children:"GridSearchCV"}),"\n",(0,i.jsx)(t.p,{children:"GridSearchCV l\xe0 ph\u01b0\u01a1ng ph\xe1p GridSearch s\u1eed d\u1ee5ng t\u1ed1i \u01b0u d\u1ef1a tr\xean Cross Validation thay v\xec chia t\u1eadp d\u1eef li\u1ec7u th\xe0nh train/valid/test nh\u01b0 th\xf4ng th\u01b0\u1eddng"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Ti\xeau ch\xed"}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"Grid Search (Th\u1ee7 c\xf4ng)"})}),(0,i.jsx)(t.th,{children:(0,i.jsx)(t.strong,{children:"GridSearchCV"})})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"C\xe1ch ho\u1ea1t \u0111\u1ed9ng"})}),(0,i.jsxs)(t.td,{children:["Duy\u1ec7t qua t\u1ea5t c\u1ea3 c\xe1c t\u1ed5 h\u1ee3p tham s\u1ed1  ",(0,i.jsx)("br",{}),"tr\xean m\u1ed9t t\u1eadptrain/test c\u1ed1 \u0111\u1ecbnh"]}),(0,i.jsxs)(t.td,{children:["Duy\u1ec7t qua t\u1ea5t c\u1ea3 c\xe1c t\u1ed5 h\u1ee3p tham s\u1ed1 ",(0,i.jsx)("br",{}),"v\xe0 s\u1eed d\u1ee5ng Cross-Validation (CV)  \u0111\u1ec3 ",(0,i.jsx)("br",{}),"\u0111\xe1nh gi\xe1 \u0111\u1ed9 ch\xednh x\xe1c tr\xean nhi\u1ec1u t\u1eadp con"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Cross-Validation (CV)"})}),(0,i.jsx)(t.td,{children:"\u274c Kh\xf4ng d\xf9ng CV, ch\u1ec9 train/test 1 l\u1ea7n"}),(0,i.jsx)(t.td,{children:"\u2705 D\xf9ng CV (k-fold) \u0111\u1ec3 ki\u1ec3m tra \u0111\u1ed9 \u1ed5n \u0111\u1ecbnh"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"S\u1ed1 l\u1ea7n train m\xf4 h\xecnh"})}),(0,i.jsx)(t.td,{children:"\ud83d\udd39 B\u1eb1ng s\u1ed1 t\u1ed5 h\u1ee3p tham s\u1ed1 th\u1eed nghi\u1ec7m"}),(0,i.jsx)(t.td,{children:"\ud83d\udd39 B\u1eb1ng s\u1ed1 t\u1ed5 h\u1ee3p tham s\u1ed1 * s\u1ed1 l\u01b0\u1ee3ng fold c\u1ee7a CV"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"T\u1ed1c \u0111\u1ed9"})}),(0,i.jsx)(t.td,{children:"\u26a1 Nhanh h\u01a1n, do ch\u1ec9 train m\u1ed9t l\u1ea7n m\u1ed7i t\u1ed5 h\u1ee3p"}),(0,i.jsx)(t.td,{children:"\ud83d\udc22 Ch\u1eadm h\u01a1n, do train nhi\u1ec1u l\u1ea7n tr\xean t\u1eadp d\u1eef li\u1ec7u chia nh\u1ecf"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"\u0110\u1ed9 tin c\u1eady c\u1ee7a m\xf4 h\xecnh"})}),(0,i.jsx)(t.td,{children:"\ud83d\udcc9 Th\u1ea5p h\u01a1n, v\xec ch\u1ec9 \u0111\xe1nh gi\xe1 tr\xean m\u1ed9t t\u1eadp train-test"}),(0,i.jsx)(t.td,{children:"\ud83d\udcc8 Cao h\u01a1n, v\xec \u0111\xe1nh gi\xe1 tr\xean nhi\u1ec1u t\u1eadp con kh\xe1c nhau"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Nguy c\u01a1 overfitting"})}),(0,i.jsx)(t.td,{children:"\u26a0\ufe0f Cao h\u01a1n, do ch\u1ec9 test tr\xean m\u1ed9t t\u1eadp d\u1eef li\u1ec7u"}),(0,i.jsx)(t.td,{children:"\u2705 Gi\u1ea3m thi\u1ec3u overfitting, v\xec ki\u1ec3m tra tr\xean nhi\u1ec1u t\u1eadp con"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Khi n\xe0o n\xean d\xf9ng?"})}),(0,i.jsx)(t.td,{children:"\u2705 Khi d\u1eef li\u1ec7u l\u1edbn, c\u1ea7n ch\u1ea1y nhanh \u26a1"}),(0,i.jsx)(t.td,{children:"\u2705 Khi mu\u1ed1n m\xf4 h\xecnh \u1ed5n \u0111\u1ecbnh h\u01a1n, tr\xe1nh ph\u1ee5 thu\u1ed9c v\xe0o m\u1ed9t t\u1eadp d\u1eef li\u1ec7u"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.strong,{children:"Th\u01b0 vi\u1ec7n h\u1ed7 tr\u1ee3"})}),(0,i.jsx)(t.td,{children:"\ud83d\udd39 T\u1ef1 tri\u1ec3n khai th\u1ee7 c\xf4ng b\u1eb1ng Python"}),(0,i.jsxs)(t.td,{children:["\ud83d\udd39 C\xf3 s\u1eb5n trong ",(0,i.jsx)(t.code,{children:"sklearn.model_selection.GridSearchCV"})]})]})]})]}),"\n",(0,i.jsx)(t.p,{children:"Ch\xfang ta n\xean d\xf9ng GridSearchCV h\u01a1n l\xe0 grid search th\u1ee7 c\xf4ng v\xec n\xf3 gi\xfap tr\xe1nh overfitting v\xe0 gi\xfap m\xf4 h\xecnh t\u1ed5ng qu\xe1t h\u01a1n."}),"\n",(0,i.jsx)(t.p,{children:"Th\u01b0 vi\u1ec7n sklearn c\xf3 s\u1eb5n GridSearchCV, ch\xfang ta c\xf3 th\u1ec3 d\xf9ng n\xf3 \u0111\u1ec3 t\u1ed1i \u01b0u si\xeau tham s\u1ed1."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Chu\u1ea9n b\u1ecb d\u1eef li\u1ec7u"})}),"\n",(0,i.jsx)(t.p,{children:"L\u1ea7n n\xe0y ch\xfang ta s\u1ebd chia Train v\xe0 Test, sau \u0111\xf3 \u0111\u01b0a Train v\xe0o CV"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'from sklearn.model_selection import GridSearchCV\r\n# fetch dataset \r\nphishing_websites = fetch_ucirepo(id=327) \r\n  \r\n# data (as pandas dataframes) \r\nX = phishing_websites.data.features \r\ny = phishing_websites.data.targets\r\n\r\n\r\n# Chia t\u1eadp train v\xe0 test\r\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)\r\n\r\n# Ki\u1ec3m tra k\xedch th\u01b0\u1edbc d\u1eef li\u1ec7u\r\nprint(f"Train size: {X_train.shape}, Test size: {X_test.shape}")\r\n\n'})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Train size: (8844, 30), Test size: (2211, 30)\n"})})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"T\u1ea1o m\xf4 h\xecnh v\xe0 GridSearchCV"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"rf = RandomForestClassifier(random_state=42)\r\n\r\n# B\u1ed9 si\xeau tham s\u1ed1\r\nparam_grid = {\r\n    'n_estimators': [50, 100, 200],  \r\n    'max_depth': [3, 5, 10],  \r\n}\r\n\r\n# GridSearchCV (cv=5)\r\ngrid_search = GridSearchCV(rf, param_grid, cv=5, scoring='accuracy', n_jobs=-1, verbose=1)\r\ngrid_search.fit(X_train, y_train)\r\n\r\n# In k\u1ebft qu\u1ea3 t\u1ed1t nh\u1ea5t\r\nprint(\"Best Parameters:\", grid_search.best_params_)\r\nprint(\"Best CV Accuracy:\", grid_search.best_score_)\n"})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Best Parameters: {'max_depth': 10, 'n_estimators': 50}\r\nBest CV Accuracy: 0.9538677039716177\n"})})}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"\u0110\xe1nh gi\xe1 m\xf4 h\xecnh tr\xean t\u1eadp test"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'# D\u1ef1 \u0111o\xe1n v\xe0 \u0111\xe1nh gi\xe1\r\ny_pred = grid_search.predict(X_test)\r\naccuracy = accuracy_score(y_test, y_pred)\r\nprint(f"Tuned Model Accuracy on Test Set: {accuracy:.4f}")\n'})}),"\n",(0,i.jsx)("pythonoutput",{children:(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"Tuned Model Accuracy on Test Set: 0.9548\n"})})}),"\n",(0,i.jsxs)(t.p,{children:["C\xe1c b\u1ea1n c\xf3 th\u1ec3 th\u1ea5y \u0111\u1ed1i v\u1edbi GridSearchCV k\u1ebft qu\u1ea3 d\u1ef1 \u0111o\xe1n tr\xean t\u1eadp test c\xf3 \u0111\u1ed9 ch\xednh x\xe1c l\xe0 ",(0,i.jsx)(t.code,{children:"0.9548"})," , k\u1ebft qu\u1ea3 n\xe0y l\u1ea1i th\u1ea5p h\u01a1n so v\u1edbi k\u1ebft qu\u1ea3 d\u1ef1 \u0111o\xe1n tr\xean t\u1eadp test khi d\xf9ng grid search th\u1ee7 c\xf4ng l\xe0 ",(0,i.jsx)(t.code,{children:"0.9557"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"\u0110i\u1ec1u n\xe0y c\xf3 th\u1ec3 do GridSearchCV s\u1eed d\u1ee5ng CV \u0111\u1ec3 \u0111\xe1nh gi\xe1 \u0111\u1ed9 ch\xednh x\xe1c tr\xean nhi\u1ec1u t\u1eadp con, do \u0111\xf3 k\u1ebft qu\u1ea3 tr\xean t\u1eadp test c\xf3 th\u1ec3 th\u1ea5p h\u01a1n. Tuy nhi\xean, GridSearchCV gi\xfap m\xf4 h\xecnh \u1ed5n \u0111\u1ecbnh h\u01a1n."})]})}function p(n={}){const{wrapper:t}={...(0,e.R)(),...n.components};return t?(0,i.jsx)(t,{...n,children:(0,i.jsx)(l,{...n})}):l(n)}}}]);